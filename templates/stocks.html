<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradePlay - Stocks</title>
</head>
<body>
    {% include 'dashboard.html' %}
    <h1>Stocks Page</h1>
    <p>Select a stock to view its data:</p>
    <form action="/stocks" method="post">
        <select name="symbol">
            <option value="">Select a stock symbol</option>
            <option value="AAPL">Apple Inc. (AAPL)</option>
            <option value="GOOGL">Alphabet Inc. (GOOGL)</option>
            <option value="MSFT">Microsoft Corporation (MSFT)</option>
            <option value="AMZN">Meta (formerly Facebook) Inc. (META)</option>
            <option value="TSLA">Tesla Motors (TSLA)</option>
            <option value="GS">The Goldman Sachs Group, Inc. (GS)</option>
            <option value="ORCL">Oracle Corporation</option>
            <option value="DELL">Dell Inc.</option>
            <option value="SPX">The S&P 500 Index (SPX)</option>
            <option value="HPQ">Hewlett-Packard Company (HPQ)</option>
            <option value="ACN">Accenture Ltd.</option>
            <option value="TTM">Tata Motors Ltd</option>
            <option value="TTM">Tata Motors Ltd</option>
            <option value="TTM">Tata Motors Ltd</option>
        </select>
        <button type="submit">Show Stock Data</button>
    </form>
    <div id="stock-chart"></div>

    <script>
        {% if data %}
            // Extract dates and prices from data
            const dates = {{ data.timestamp }};
            const prices = {{ data.close }};

            // Create trace for the line chart
            const trace = {
                x: dates,
                y: prices,
                type: 'scatter',
                mode: 'lines+markers',
                marker: { color: 'blue' },
                line: { shape: 'spline' }
            };

            // Define layout options
            const layout = {
                title: 'Stock Prices',
                xaxis: { title: 'Date' },
                yaxis: { title: 'Price' }
            };

            // Plot the chart
            Plotly.newPlot('stock-chart', [trace], layout);
        {% endif %}
    </script>
    
    <hr>
    {% if data %}
        <h2>Stock Data for {{ symbol }}</h2>
        <table>
            <thead>
                <tr>
                    <th>Timestamp</th>
                    <th>Open</th>
                    <th>High</th>
                    <th>Low</th>
                    <th>Close</th>
                    <th>Volume</th>
                </tr>
            </thead>
            <tbody>
                {% for item in data['results'] %}
                    <tr>
                        <td>{{ item['t'] }}</td>
                        <td>{{ item['o'] }}</td>
                        <td>{{ item['h'] }}</td>
                        <td>{{ item['l'] }}</td>
                        <td>{{ item['c'] }}</td>
                        <td>{{ item['v'] }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    
    {% else %}
        <p>No data available.</p>
    {% endif %}
</body>
</html>
